<div class="card">
  <div class="card-body">
    <form [formGroup]="form">
      <div class="form-floating mb-3">
        <input
          type="text"
          class="form-control"
          id="floatingName"
          placeholder="Nome do cliente"
          formControlName="name"
        />
        <label for="floatingName">Nome do cliente</label>
      </div>
      <div class="number-address">
        <div class="form-floating">
          <input
            type="tel"
            class="form-control"
            id="floatingTel"
            placeholder="Número de telefone"
            formControlName="number"
          />
          <label for="floatingTel">Celular</label>
        </div>
        <div class="form-floating">
          <input
            type="text"
            class="form-control"
            id="floatingAddress"
            placeholder="Número de telefone"
            formControlName="address"
          />
          <label for="floatingAddress">Endereço(Opcional)</label>
        </div>
      </div>

      <button class="add-obra-btn" (click)="addNewWork()">
        <i class="bi bi-plus-lg"></i>
        Obra
      </button>

      <div
        class="obra-form"
        formArrayName="works"
        *ngFor="let obra of getObrasFormArray(); let i = index"
      >
        <form [formGroupName]="i">
          <h5>{{i + 1}}</h5>
          <div class="name-address">
            <div class="form-floating">
              <input
                class="form-control"
                id="floatingName"
                formControlName="name"
              />
              <label for="floatingName">Nome</label>
            </div>
            <div class="form-floating">
              <input
                class="form-control"
                id="floatingAddress"
                formControlName="address"
              />
              <label for="floatingAddress">Endereço</label>
            </div>
          </div>
          <div class="type-dates">
            <div class="form-floating">
              <select
                class="form-select"
                id="floatingType"
                formControlName="serviceType"
              >
                <option value="Marmoraria">Marmoraria</option>
                <option value="Vidraçaria">Vidraçaria</option>
                <option value="Ambos">Ambos</option>
              </select>
              <label for="floatingType">Tipo</label>
            </div>
            <div class="form-floating">
              <input
                type="date"
                class="form-control date-input"
                id="floatingInitialDate"
                formControlName="initialDate"
              />
              <label for="floatingInitialDate">Início</label>
            </div>
            <div class="form-floating">
              <input
                type="date"
                class="form-control date-input"
                id="floatingFinishDate"
                formControlName="finishDate"
              />
              <label for="floatingFinishDate">Término</label>
            </div>
            <button (click)="removeWork(i)">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </form>
      </div>
      <div class="action-buttons">
        <button (click)="onSubmit()"><i class="bi bi-save"></i> Salvar</button>

      </div>
    </form>
  </div>
</div>
<div class="loading-container" *ngIf="isLoading">
  <div class="spinner-grow" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <span>Salvando os dados...</span>
</div>

<div
  class="toast align-items-center"
  id="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
>
  <div class="d-flex">
    <div class="toast-body">
      <i class="bi bi-exclamation-circle"></i>
      {{ toastMessage }}
    </div>
  </div>
</div>
